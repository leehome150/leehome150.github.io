<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>æ‰‹æŠŠæ‰‹æ•™ä½ å†™EventHubï¼ˆå‘å¸ƒ-è®¢é˜…ï¼‰</title>
    <url>/posts/ee1ff54b/</url>
    <content><![CDATA[<blockquote>
<p>æ‰‹å†™ EventBus ä½œä¸ºç»å…¸çš„å‰ç«¯æ‰‹å†™é¢è¯•é¢˜ï¼Œåœ¨å·¥ä½œä¹‹ä½™æˆ‘è§‰å¾—è¿˜æ˜¯å¾—è®°å½•ä¸€ä¸‹ ğŸ˜Š</p>
</blockquote>
<p><strong>ä»€ä¹ˆæ˜¯ EventHub</strong></p>
<p>EventHub æ˜¯åŸºäº<strong>å‘å¸ƒè®¢é˜…æ¨¡å¼</strong>å®ç°çš„ä¸€ä¸ªå®ä¾‹, ç¿»è¯‘ä¸ºäº‹ä»¶ä¸­å¿ƒ,å¸¸ç”¨äºå¤šæ¨¡å—(ç»„ä»¶)é—´çš„é€šä¿¡ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬å°±ç®€å•çš„å®ç° EventHub çš„<code>å‘å¸ƒã€è®¢é˜…å’Œå–æ¶ˆè®¢é˜…</code>ï¼š<br>é¦–å…ˆæˆ‘ä»¬ç¡®å®š<code>Api</code>:</p>
<ul>
<li>on è®¢é˜…ï¼ˆç›‘å¬ï¼‰</li>
<li>emit å‘å¸ƒï¼ˆè§¦å‘ï¼‰</li>
<li>off å–æ¶ˆè®¢é˜…</li>
</ul>
<p><strong>å®ç°å‘å¸ƒå’Œè®¢é˜…</strong></p>
<p>æˆ‘ä»¬å¾—ç”¨ä¸€ä¸ªå˜é‡<strong>eventMap</strong>æ¥æš‚å­˜äº‹ä»¶åå­—ï¼ˆkeyï¼‰å’Œäº‹ä»¶(value)ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªæ•°ç»„æ¥è®°å½•äº‹ä»¶ï¼ˆå› ä¸ºè€ƒè™‘å¤šæ¬¡è®¢é˜…ï¼‰ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventHub</span> </span>&#123;</span><br><span class="line">  private eventMap: &#123; [key: string]: <span class="built_in">Array</span>&lt;<span class="function">(<span class="params">params?</span>) =&gt;</span> <span class="keyword">void</span>&gt; &#125; = &#123;&#125;;</span><br><span class="line">  <span class="function"><span class="title">on</span>(<span class="params">eventName, fn</span>)</span> &#123;&#125;</span><br><span class="line">  <span class="function"><span class="title">emit</span>(<span class="params">eventName</span>)</span> &#123;&#125;</span><br><span class="line">  <span class="function"><span class="title">off</span>(<span class="params">eventName</span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> EventHub;</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬è®¢é˜…ä¸€ä¸ªäº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªäº‹ä»¶ push åˆ°è®¢é˜…çš„ä¸œè¥¿çš„äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œæ¯”å¦‚æˆ‘åœ¨æ‰‹æœºé—¹é’Ÿé‡Œé¢è®¢äº†ä¸ª 3 ç§’åçš„é—¹é’Ÿ:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> EventHub <span class="keyword">from</span> <span class="string">&quot;../src/index&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> eventHub = <span class="keyword">new</span> EventHub();</span><br><span class="line"></span><br><span class="line">eventHub.on(<span class="string">&quot;é—¹é’Ÿ&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;é—¹é’Ÿå“äº†&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">eventHub.emit(<span class="string">&quot;é—¹é’Ÿ&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬åœ¨ç±»é‡Œé¢çš„<code>on</code>å‡½æ•°æŠŠäº‹ä»¶ push è¿›å»ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventHub</span> </span>&#123;</span><br><span class="line">  private eventMap: &#123; [key: string]: <span class="built_in">Array</span>&lt;<span class="function">(<span class="params">params?ï¼šany</span>) =&gt;</span> <span class="keyword">void</span>&gt; &#125; = &#123;&#125;;</span><br><span class="line">  <span class="function"><span class="title">on</span>(<span class="params">eventName: string, fn: (params?: any) =&gt; <span class="keyword">void</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.eventMap[eventName] = <span class="built_in">this</span>.eventMap[eventName] || [];</span><br><span class="line">    <span class="built_in">this</span>.eventMap[eventName].push(fn);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">emit</span>(<span class="params">eventName</span>)</span> &#123;&#125;</span><br><span class="line">  <span class="function"><span class="title">off</span>(<span class="params">eventName</span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> EventHub;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åœ¨<code>emit</code>è§¦å‘æ‰§è¡Œé€»è¾‘ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventHub</span> </span>&#123;</span><br><span class="line">  private eventMap: &#123; [key: string]: <span class="built_in">Array</span>&lt;<span class="function">(<span class="params">params?: any</span>) =&gt;</span> <span class="keyword">void</span>&gt; &#125; = &#123;&#125;;</span><br><span class="line">  <span class="function"><span class="title">on</span>(<span class="params">eventName: string, fn: (params?: any) =&gt; <span class="keyword">void</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.eventMap[eventName] = <span class="built_in">this</span>.eventMap[eventName] || [];</span><br><span class="line">    <span class="built_in">this</span>.eventMap[eventName].push(fn);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">emit</span>(<span class="params">eventName: string</span>)</span> &#123;</span><br><span class="line">    (<span class="built_in">this</span>.eventMap[eventName] || []).forEach(<span class="function">(<span class="params">fn</span>) =&gt;</span> fn());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">off</span>(<span class="params">eventName: string</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(eventName);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> EventHub;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œè§¦å‘çš„ä»£ç ï¼Œçœ‹æ§åˆ¶å°ï¼ˆæç¤ºï¼šnode è¿è¡Œ ts æ–‡ä»¶è¯·ä¸‹è½½ ts-nodeï¼‰</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7adeff31547c4b26b739a077107dd40e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"><br><strong>å®ç°å–æ¶ˆè®¢é˜…ï¼š</strong><br>å½“æˆ‘ä»¬åœ¨ emit ä¹‹å‰ off é—¹é’Ÿçš„è®¢é˜…</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> EventHub <span class="keyword">from</span> <span class="string">&quot;../src/index&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> eventHub = <span class="keyword">new</span> EventHub();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;é—¹é’Ÿå“äº†&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;;</span><br><span class="line">eventHub.on(<span class="string">&quot;é—¹é’Ÿ&quot;</span>, fn);</span><br><span class="line">eventHub.off(<span class="string">&quot;é—¹é’Ÿ&quot;</span>, fn);</span><br><span class="line">eventHub.emit(<span class="string">&quot;é—¹é’Ÿ&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>åŠ ä¸Šå–æ¶ˆè®¢é˜…çš„é€»è¾‘ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">off</span>(<span class="params">eventName: string, fn: (params?: any) =&gt; <span class="keyword">void</span></span>)</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> index = <span class="built_in">this</span>.eventMap[eventName].findIndex(<span class="function">(<span class="params">item</span>) =&gt;</span> item === fn);</span><br><span class="line">   <span class="keyword">if</span> (index === -<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">   <span class="built_in">this</span>.eventMap[eventName].splice(index, <span class="number">1</span>);</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">&quot;å–æ¶ˆé—¹é’ŸæˆåŠŸ&quot;</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå–æ¶ˆæˆåŠŸï¼š</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cece88b0c35949d7b82db8fca752b106~tplv-k3u1fbpfcp-watermark.image" alt="image.png"><br><a href="https://github.com/leehome150/EventHub">æºä»£ç ç‚¹å‡»</a></p>
]]></content>
      <categories>
        <category>æ‰‹å†™ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>eventHub</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo nexT 7.8.0 æ·»åŠ èƒŒæ™¯å›¾ç‰‡</title>
    <url>/posts/b56cb502/</url>
    <content><![CDATA[<p>ç‰ˆæœ¬ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;hexo&quot;: &quot;^5.0.0&quot;,</span><br><span class="line">&quot;NexT&quot;: &quot;7.8.0&quot;,</span><br></pre></td></tr></table></figure>

<p><strong>ç”±äº next ç‰ˆæœ¬è¾ƒæ–°ï¼Œnext ä¸»é¢˜æ›´æ–°è‡³ 7.0+ç‰ˆæœ¬åå–æ¶ˆäº†_custom æ–‡ä»¶å¤¹ä»¥åŠ custom.styl æ–‡ä»¶ã€‚</strong></p>
<p>åœ¨è¿™é‡Œæé†’ä¸‹<strong>ä¸è¦æ‰“å¼€</strong>themes/next/_config.yml é…ç½®æ–‡ä»¶æœç´¢ custom ä»¥ä¸‹ä»£ç é‡Œçš„ style çš„ æ³¨é‡Šï¼ˆåšä¸»è¸©è¿‡å‘ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">custom_file_path:</span><br><span class="line">  #head: source/_data/head.swig</span><br><span class="line">  #header: source/_data/header.swig</span><br><span class="line">  #sidebar: source/_data/sidebar.swig</span><br><span class="line">  #postMeta: source/_data/post-meta.swig</span><br><span class="line">  #postBodyEnd: source/_data/post-body-end.swig</span><br><span class="line">  #footer: source/_data/footer.swig</span><br><span class="line">  #bodyEnd: source/_data/body-end.swig</span><br><span class="line">  #variable: source/_data/variables.styl</span><br><span class="line">  #mixin: source/_data/mixins.styl</span><br><span class="line">  # style: source/_data/styles.styl</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆåœ¨ themes/next/souces/images æ·»åŠ ä½ å–œæ¬¢çš„èƒŒæ™¯å›¾ç‰‡ï¼Œè¿™é‡Œæˆ‘æ¨èåœ¨çŸ¥ä¹é‡Œé¢æ‰¾æ¨èã€‚</p>
<p>ç„¶ååœ¨ themes/next/souces ä¸‹æ–°å»º_data æ–‡ä»¶ï¼Œåˆ›å»º styles.styl,æ·»åŠ å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">    background:url(/images/background.jpg); // å¯ä»¥æ˜¯è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯é“¾æ¥</span><br><span class="line">    background-repeat: no-repeat; // ä¸é‡å¤</span><br><span class="line">    background-attachment:fixed; // å›ºå®šä½èƒŒæ™¯å›¾ç‰‡</span><br><span class="line">    background-position:50% 50%; // å›¾ç‰‡ä½ç½®ï¼šå±…ä¸­</span><br><span class="line">    background-size: 100% 100%; // å›¾ç‰‡é•¿å®½æ‰©å……ä¸º100%</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ€åéœ€è¦åœ¨ yourblog/themes/next/source/css ä¸‹æ‰¾åˆ° main.styl æ–‡ä»¶ï¼Œå¹¶åœ¨æœ€åä¸€è¡Œæ·»ä¸Šå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@import &quot;../_data/styles.styl&quot;;</span><br></pre></td></tr></table></figure>

<p>æœ€åçš„æœ€å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥çœ‹åˆ°æœ€ç»ˆæ•ˆæœäº†ï¼ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Next.js çš„ä¸‰ç§æ¸²æŸ“æ–¹å¼</title>
    <url>/posts/b2ae764/</url>
    <content><![CDATA[<blockquote>
<p>å®¢æˆ·ç«¯æ¸²æŸ“(BSR)<br>é™æ€é¡µé¢ç”Ÿæˆ(SSG)<br>æœåŠ¡ç«¯æ¸²æŸ“(SSR)</p>
</blockquote>
<ul>
<li><h4 id="å®¢æˆ·ç«¯æ¸²æŸ“-BSR"><a href="#å®¢æˆ·ç«¯æ¸²æŸ“-BSR" class="headerlink" title="å®¢æˆ·ç«¯æ¸²æŸ“(BSR)"></a>å®¢æˆ·ç«¯æ¸²æŸ“(BSR)</h4></li>
</ul>
<p>é¡¾åæ€ä¹‰ï¼Œå®¢æˆ·ç«¯æ¸²æŸ“åªæ˜¯åœ¨æµè§ˆå™¨æ‰§è¡Œçš„æ¸²æŸ“ï¼Œæˆ‘ä»¬ä¸€åŠç”¨ JSã€Reactã€Vue åˆ›å»º HTML,ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬æ¸²æŸ“ä¸€ä¸ªåˆ—è¡¨:<br>æˆ‘ä»¬å…ˆé€šè¿‡ usePost è¿™ä¸ªè‡ªå®šä¹‰ Hook é€šè¿‡ axios è¿”å›ä¸€ä¸ªçš„æ–‡ä»¶åˆ—è¡¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const usePosts = () =&gt; &#123;</span><br><span class="line">  const [posts, set_posts] = useState&lt;Acticle[]&gt;();</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    axios.get(&quot;/api/v1/posts&quot;).then((res) =&gt; &#123;</span><br><span class="line">      set_posts(res.data);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, []);</span><br><span class="line">  return &#123; posts &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç„¶åæŠŠä»–æ¸²æŸ“åœ¨é¡µé¢ä¸Šï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const posts = () =&gt; &#123;</span><br><span class="line">  const &#123; posts &#125; = usePosts();</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;æ–‡ç« åˆ—è¡¨&lt;/h1&gt;</span><br><span class="line">      &#123;posts?.map((item) =&gt; &#123;</span><br><span class="line">        return &lt;div key=&#123;item.id&#125;&gt;&#123;item.title&#125;&lt;/div&gt;;</span><br><span class="line">      &#125;)&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç”±ä¸Šé¢æˆ‘ä»¬å¯ä»¥çŸ¥é“å®¢æˆ·ç«¯æ¸²æŸ“é€šè¿‡<strong> AJAX</strong> å¾—åˆ°æˆåŠŸå“åº”ï¼Œç„¶åæ¸²æŸ“åŠ¨æ€å†…å®¹ï¼ˆé™æ€å†…å®¹ä¸æœåŠ¡å™¨æ¸²æŸ“ï¼Œæ¯”å¦‚ï¼šæ–‡ç« åˆ—è¡¨è¿™å‡ ä¸ªå­—ï¼‰ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç°å¦‚ä»Šæ¯”è¾ƒå¸¸ç”¨çš„æ¸²æŸ“æ–¹å¼ï¼Œå› ä¸ºå¤§éƒ¨åˆ†å…¬å¸éƒ½æ˜¯å‰åç«¯åˆ†ç¦»ã€‚</p>
<p>ä»–çš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼š</p>
<ul>
<li>ç™½å±<br>ä½†æ˜¯æˆ‘ä»¬åœ¨ set_posts(res.data)ä¹‹å‰æ‰“ä¸ª debugger,å‘ç°é¡µé¢çœ‹ä¸åˆ°æ–‡ç« äº†ã€‚</li>
<li>SEO ä¸å‹å¥½<br>æˆ‘ä»¬æ‰“å¼€æºä»£ç ä¼šå‘ç°çœ‹ä¸åˆ°æ¸²æŸ“çš„æ•°æ®ï¼Œåªçœ‹åˆ°å¼•ç”¨çš„ JS,å› ä¸ºæœç´¢å¼•æ“ä¸ä¼šæ‰§è¡Œ JS,åªèƒ½çœ‹åˆ° HTMLã€‚</li>
</ul>
<p>è¿™ä¹Ÿæœ‰äº†ä¸‹é¢ä¸¤ç§æ¸²æŸ“æ–¹å¼çš„ç”¨æ­¦ä¹‹åœ°ï¼š</p>
<ul>
<li><h4 id="é™æ€æ–‡ä»¶ç”Ÿæˆ-SSG"><a href="#é™æ€æ–‡ä»¶ç”Ÿæˆ-SSG" class="headerlink" title="é™æ€æ–‡ä»¶ç”Ÿæˆ(SSG)"></a>é™æ€æ–‡ä»¶ç”Ÿæˆ(SSG)</h4></li>
</ul>
<p>èƒŒæ™¯ï¼šå¦‚æœè¿”å›çš„æ–‡ä»¶ä¸ç”¨æˆ·æ— å…³ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¸ºä»€ä¹ˆä¸ä¸€æ¬¡ç”Ÿæˆï¼Œç„¶åå‘ç»™æ¯ä¸ªäººï¼ŒN æ¬¡å®¢æˆ·ç«¯æ¸²æŸ“å°±å˜æˆäº†ä¸€æ¬¡é™æ€é¡µé¢ç”Ÿæˆï¼Œè¿™ä¸ªå°±å«åšåŠ¨æ€å†…å®¹é™æ€åŒ–ã€‚</p>
<p>Next.js æä¾› getStaticProps è¿™ä¸ª API,å°±å¯ä»¥ç›´æ¥é€šè¿‡ Props ä¼ å…¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const posts: NextPage&lt;Props&gt; = (props) =&gt; &#123;</span><br><span class="line">  const &#123; posts &#125; = props;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&quot;content&quot;&gt;</span><br><span class="line">      &lt;h1&gt;æ–‡ç« åˆ—è¡¨&lt;/h1&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;posts?.map((item) =&gt; &#123;</span><br><span class="line">          return (</span><br><span class="line">            &lt;Link href=&#123;`/posts/$&#123;item.title&#125;`&#125; key=&#123;item.title&#125;&gt;</span><br><span class="line">              &lt;a&gt;</span><br><span class="line">                &lt;li key=&#123;item.title&#125;&gt;</span><br><span class="line">                  &#123;item.id&#125;.&#123;item.title&#125;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">              &lt;/a&gt;</span><br><span class="line">            &lt;/Link&gt;</span><br><span class="line">          );</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default posts;</span><br><span class="line"></span><br><span class="line">export const getStaticProps = async () =&gt; &#123;</span><br><span class="line">  const posts = await getPosts();</span><br><span class="line">  return &#123;</span><br><span class="line">    props: &#123; posts: JSON.parse(JSON.stringify(posts)) &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„å¥½å¤„ï¼šæˆ‘ä»¬ä¸ç”¨ AJAX ä¹Ÿèƒ½æ‹¿åˆ°å†…å®¹ï¼Œä¸ä¼šç™½å±ï¼Œè€Œä¸”æˆ‘ä»¬æŸ¥çœ‹æºä»£ç ä¹Ÿèƒ½çœ‹åˆ°æ•°æ®å†…å®¹ï¼Œä¹Ÿæœ‰åˆ©äº SEOã€‚</p>
<ul>
<li><h4 id="æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰"><a href="#æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰" class="headerlink" title="æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰"></a>æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰</h4>å¦‚æœåŠ¨æ€å†…å®¹ä¸ç”¨æˆ·å…ˆå…³è”ï¼Œè¾ƒéš¾æå‰é™æ€åŒ–ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ã€‚<br>Next.js æä¾› getStaticProps è¿™ä¸ª API,å°±å¯ä»¥ç›´æ¥é€šè¿‡ Props ä¼ å…¥,æ¯”å¦‚æˆ‘ä»¬è·å–ç”¨æˆ·çš„æµè§ˆå™¨ç±»å‹ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const Index: NextPage&lt;Props&gt; = (props) =&gt; &#123;</span><br><span class="line">const &#123; browser &#125; = props;</span><br><span class="line">return (</span><br><span class="line">  &lt;div className=&#123;styles.container&#125;&gt;</span><br><span class="line">    &lt;h1&gt;</span><br><span class="line">      ä½ çš„æµè§ˆå™¨æ˜¯&#123;browser.name&#125;,ç‰ˆæœ¬ä¸º&#123;browser.version&#125;</span><br><span class="line">    &lt;/h1&gt;</span><br><span class="line">    &lt;img src=&#123;img&#125; alt=&quot;&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">);</span><br><span class="line">&#125;;</span><br><span class="line">export default Index;</span><br><span class="line">export const getServerSideProps: GetServerSideProps = async (context) =&gt; &#123;</span><br><span class="line">const ua = context.req.headers[&quot;user-agent&quot;];</span><br><span class="line">const result = new UAParser(ua).getResult();</span><br><span class="line">return &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    browser: result.browser,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
æœåŠ¡ç«¯æ¸²æŸ“çš„å¥½å¤„ä¹Ÿæ˜¯ä¸ä¼šç™½å±ï¼Œæœ‰åˆ©äº SEO ä¼˜åŒ–ï¼Œç›¸æ¯”äº SSG èƒ½å®ç°æœåŠ¡ç«¯æ¸²æŸ“è·Ÿç”¨æˆ·ç›¸å…³çš„åŠ¨æ€å†…å®¹ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>Next.js</category>
      </categories>
      <tags>
        <tag>Next.js</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•ç†è§£Vueçš„.syncä¿®é¥°ç¬¦ä»¥åŠv-model</title>
    <url>/posts/1c175475/</url>
    <content><![CDATA[<h3 id="sync"><a href="#sync" class="headerlink" title=".sync"></a>.sync</h3><p>vue ä¿®é¥°ç¬¦ sync çš„åŠŸèƒ½æ˜¯ï¼šå½“ä¸€ä¸ªå­ç»„ä»¶æ”¹å˜äº†ä¸€ä¸ª props çš„å€¼æ—¶ï¼Œè¿™ä¸ªå˜åŒ–ä¹Ÿä¼šåŒæ­¥åˆ°çˆ¶ç»„ä»¶ä¸­æ‰€ç»‘å®šã€‚</p>
<p>è¿™ä¸ªåŠŸèƒ½æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p>
<p>Vue ç»„ä»¶ä¸èƒ½ä¿®æ”¹ props å¤–éƒ¨æ•°æ®ï¼Œä½†æ˜¯$emitå¯ä»¥è§¦å‘äº‹ä»¶ï¼Œå¹¶ä¼ å‚ï¼Œ$event å¯è·å–$emit çš„å‚æ•°ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//Child.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;child&quot;&gt;</span><br><span class="line">   å­ç»„ä»¶ï¼š&#123;&#123;money&#125;&#125;</span><br><span class="line">//è§¦å‘update:moneyäº‹ä»¶ï¼Œå¹¶ä¼ å‚</span><br><span class="line">   &lt;button @click=&quot;$emit(&#x27;update:money&#x27;,money-100)&quot;&gt;&lt;span&gt;èŠ±é’±&lt;/span&gt;&lt;/button&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line"></span><br><span class="line">props:[&quot;money&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">#child&#123;</span><br><span class="line">  border :1px solid red;</span><br><span class="line">  padding:2px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶å$event è·å–ä¼ çš„å‚æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//App.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">   çˆ¶ç»„ä»¶ï¼š æˆ‘ç°åœ¨æœ‰&#123;&#123;total&#125;&#125;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">//$event è·å–ä¼ çš„å‚æ•°èµ‹å€¼ç»™total</span><br><span class="line">    &lt;Child :money=&quot;total&quot; v-on:update:money=&quot;total=$event&quot;/&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Child from&quot;./Child.vue&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  data()&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">total:10000</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123; Child:Child&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">#app&#123;</span><br><span class="line">  border :2px solid blue;</span><br><span class="line">  padding:2px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºè¿™ç§åœºæ™¯å¾ˆå¸¸è§ï¼Œæ‰€ä»¥å°¤é›¨æºªå‘æ˜äº†.sync ä¿®é¥°ç¬¦ï¼Œä¸Šé¢çš„ä»£ç <strong>:money=â€totalâ€ v-on:update:money=â€total=$eventâ€å¯ä»¥ç®€åŒ–ä¸º:money.sync=â€totalâ€</strong></p>
<p>ä¸‹é¢æ˜¯è¿è¡ŒåŠ¨ç”»ï¼š</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/5/12/17207b0ebb162b47~tplv-t2oaga2asx-watermark.awebp"></p>
<p><a href="https://codesandbox.io/s/eloquent-wave-bc7bb">ä»£ç ç‚¹å‡»</a></p>
<h3 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h3><p>v-model ä¹Ÿæ˜¯ä¸ªè¯­æ³•ç³–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v-model=&quot;x&quot;ç­‰ä»·äº ï¼švalue=&quot;x&quot;,@input=&quot;x=$event.target.value&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å½“ v-model ç”¨äºæ™®é€š input ä¸Š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &#123;&#123;message&#125;&#125;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    &lt;input v-model=&quot;message&quot; placeholder=&quot;ä½ å¥½&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;App&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      message: &quot;&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åŠ¨ç”»æ¼”ç¤ºï¼š</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/3/17277f6ca1d24f4d~tplv-t2oaga2asx-watermark.awebp"></p>
<p>å½“ v-model ç”¨äºç»„ä»¶ä¸Š</p>
<p>çˆ¶ç»„ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &#123;&#123;price&#125;&#125;</span><br><span class="line">        &lt;hr/&gt;</span><br><span class="line">        &lt;test v-model=&quot;price&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import test from &#x27;./components/Test.vue&#x27;;</span><br><span class="line">    export default &#123;</span><br><span class="line">        components:&#123;test&#125;,</span><br><span class="line">        name: &quot;App&quot;,</span><br><span class="line">        data()&#123;</span><br><span class="line">            return&#123;</span><br><span class="line">                price:100</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">&lt;/style&gt;å­ç»„ä»¶</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å­ç»„ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label&gt;</span><br><span class="line">      &lt;input ref=&quot;input&quot; :value=&quot;value&quot;</span><br><span class="line">      @input=&quot;$emit(&#x27;input&#x27;, $event.target.value)&quot;//å­ç»„ä»¶è§¦å‘äº‹ä»¶ï¼ŒæŠŠè¾“å…¥çš„å‚æ•°ä¼ ç»™price</span><br><span class="line">      &gt;</span><br><span class="line">    &lt;/label&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;App&quot;,</span><br><span class="line">  props: [&quot;value&quot;],//å­ç»„ä»¶æŠŠvalueä¼ ç»™çˆ¶ç»„ä»¶ï¼Œçˆ¶ç»„ä»¶ç»‘å®švalue=&quot;price&quot;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”±ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå­ç»„ä»¶æŠŠ value ä¼ ç»™çˆ¶ç»„ä»¶ï¼Œå› ä¸º<strong> v-model=â€priceâ€ç­‰ä»·äº ï¼švalue=â€priceâ€,@input=â€price=$event.target.valueâ€,</strong>çˆ¶ç»„ä»¶åŠ¨æ€ç»‘å®šäº† valueï¼Œç„¶å input äº‹ä»¶é‚£è¾“å…¥çš„ value å‚æ•°ä¼ ç»™äº† price,æ‰€ä»¥æˆ‘ä»¬å°±èƒ½çœ‹åˆ°ä»¥ä¸‹æ•ˆæœï¼š</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/3/1727846768ecc1e0~tplv-t2oaga2asx-watermark.awebp"></p>
]]></content>
      <categories>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>mobx å’Œ mobx-react å…¥é—¨</title>
    <url>/posts/e13966ac/</url>
    <content><![CDATA[<h2 id="1-ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†ï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†ï¼Ÿ" class="headerlink" title="1.ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†ï¼Ÿ"></a>1.ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†ï¼Ÿ</h2><h3 id="ç»„ä»¶å†…"><a href="#ç»„ä»¶å†…" class="headerlink" title="ç»„ä»¶å†…"></a>ç»„ä»¶å†…</h3><ul>
<li>class ç»„ä»¶ state</li>
<li>å‡½æ•°ç»„ä»¶ useState</li>
</ul>
<h3 id="ç»„ä»¶é—´"><a href="#ç»„ä»¶é—´" class="headerlink" title="ç»„ä»¶é—´"></a>ç»„ä»¶é—´</h3><ul>
<li>çˆ¶å­ä¹‹é—´é€šä¿¡ç”¨ props ä¼ é€’</li>
<li>çˆ·å­™ä¹‹é—´é€šä¿¡ä¼ é€’ä¸¤æ¬¡ props</li>
<li>ä½†æ˜¯ä»»æ„ç»„ä»¶ï¼Ÿ</li>
</ul>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ° mobx å’Œ mobx-reactï¼ˆè¿™é‡Œä¸è®² reduxï¼‰</p>
<h2 id="2-mobx"><a href="#2-mobx" class="headerlink" title="2.mobx"></a>2.mobx</h2><h3 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h3><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/7/7/173270ed17dabb91~tplv-t2oaga2asx-image.image"></p>
<h3 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h3><p><a href="https://cn.mobx.js.org/">mobx ä¸­æ–‡æ–‡æ¡£</a></p>
<h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><ul>
<li>State</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; observable, computed, action, autorun &#125; from &quot;mobx&quot;;</span><br><span class="line">//Stateï¼Œè¢«è§‚å¯Ÿè€…</span><br><span class="line">const todos = (observable([</span><br><span class="line"> &#123;</span><br><span class="line"> title: &quot;èµ·åºŠ&quot;,</span><br><span class="line"> completed: false</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line"> title: &quot;ç©¿â¾&quot;,</span><br><span class="line"> completed: false</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line"> title: &quot;æ´—æ¼±&quot;,</span><br><span class="line"> completed: false</span><br><span class="line"> &#125;</span><br><span class="line">]));</span><br></pre></td></tr></table></figure>

<ul>
<li>Computed</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//Computed values ,ç”± State çš„æ›´æ–°è§¦å‘</span><br><span class="line">let uncompletedCount = computed(</span><br><span class="line">() =&gt; todos.filter(todo =&gt; !todo.completed).length</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>Reactions</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//Reactionsï¼Œ ç”± State å’Œ Computed Values çš„æ”¹å˜è§¦å‘æ‰§â¾</span><br><span class="line">autorun(() =&gt; &#123;</span><br><span class="line">console.log(</span><br><span class="line">`å‰©ä½™ä»»åŠ¡:$&#123;uncompletedCount&#125;`,</span><br><span class="line">todos</span><br><span class="line">.filter(todo =&gt; !todo.completed)</span><br><span class="line">.map(todo =&gt; todo.title)</span><br><span class="line">.join(&quot;, &quot;)</span><br><span class="line">);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>Actions</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const doTask = action(() =&gt; &#123;</span><br><span class="line">todos.find(todo =&gt; !todo.completed).completed = true</span><br><span class="line">&#125;);</span><br><span class="line">doTask()</span><br></pre></td></tr></table></figure>

<h3 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h3><p><strong>ä»€ä¹ˆæ˜¯è£…é¥°å™¨ Decorators</strong></p>
<ul>
<li>æ ¸â¼¼æ€æƒ³ï¼šä¿ç•™åŸæ¥çš„åå­—å’Œä¸»åŠŸèƒ½ï¼Œæ·»åŠ â¼€<br>äº›é™„åº¸åŠŸèƒ½</li>
<li>â¼€ç§è®¾è®¡æ¨¡å¼ï¼Œâ½¤æ¥â€œè£…é¥°â€â¼€ä¸ªå‡½æ•°æˆ–å¯¹è±¡</li>
<li>ES7 æ–°è¯­æ³•ï¼Œâ½¤æ¥è£…é¥°ç±»æˆ–è€…å±æ€§</li>
</ul>
<p>@observable å¯ä»¥åœ¨å®ä¾‹å­—æ®µå’Œå±æ€§ getter ä¸Šä½¿ç”¨ã€‚ å¯¹äºå¯¹è±¡çš„å“ªéƒ¨åˆ†éœ€è¦æˆä¸ºå¯è§‚å¯Ÿçš„ï¼Œ@observable æä¾›äº†ç»†ç²’åº¦çš„æ§åˆ¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; observable, computed &#125; from &quot;mobx&quot;;</span><br><span class="line"></span><br><span class="line">class OrderLine &#123;</span><br><span class="line">    @observable price = 0;</span><br><span class="line">    @observable amount = 1;</span><br><span class="line"></span><br><span class="line">    @computed get total() &#123;</span><br><span class="line">        return this.price * this.amount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="mobx-çš„è£…é¥°å™¨å†™æ³•"><a href="#mobx-çš„è£…é¥°å™¨å†™æ³•" class="headerlink" title="mobx çš„è£…é¥°å™¨å†™æ³•"></a>mobx çš„è£…é¥°å™¨å†™æ³•</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; observable, autorun, computed, action &#125; from &#x27;mobx&#x27;;</span><br><span class="line">class Todo &#123;</span><br><span class="line"> @observable todos = []</span><br><span class="line"> constructor() &#123;</span><br><span class="line"> autorun(() =&gt; &#123;</span><br><span class="line"> console.log(</span><br><span class="line"> `å‰©ä½™ä»»åŠ¡:$&#123;this.uncompletedCount&#125;`,</span><br><span class="line"> this.todos</span><br><span class="line"> .filter(todo =&gt; !todo.completed)</span><br><span class="line"> .map(todo =&gt; todo.title)</span><br><span class="line"> .join(&quot;, &quot;)</span><br><span class="line"> );</span><br><span class="line"> &#125;);</span><br><span class="line"> &#125;</span><br><span class="line"> @computed get uncompletedCount() &#123;</span><br><span class="line"> return this.todos.filter(todo =&gt; !todo.completed).length;</span><br><span class="line"> &#125;</span><br><span class="line"> @action addTodo(title) &#123;</span><br><span class="line"> this.todos.push(&#123;</span><br><span class="line"> title: title,</span><br><span class="line"> completed: false</span><br><span class="line"> &#125;);</span><br><span class="line"> &#125;</span><br><span class="line"> @action doTask()&#123;</span><br><span class="line"> this.todos.find(todo =&gt; !todo.completed).completed = true</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="headerlink" title="æ ¸å¿ƒæ€æƒ³"></a>æ ¸å¿ƒæ€æƒ³</h3><p>çŠ¶æ€çš„æ”¹å˜å¼•å‘â¼€ç³»åˆ—â¾ƒåŠ¨â¾ä¸º</p>
<h3 id="React-é¡¹â½¬ä¸­ä½¿â½¤è£…é¥°å™¨"><a href="#React-é¡¹â½¬ä¸­ä½¿â½¤è£…é¥°å™¨" class="headerlink" title="React é¡¹â½¬ä¸­ä½¿â½¤è£…é¥°å™¨"></a>React é¡¹â½¬ä¸­ä½¿â½¤è£…é¥°å™¨</h3><ul>
<li>yarn eject</li>
<li>yarn add @babel/plugin-proposal-decorators</li>
<li>ä¿®æ”¹ package.jsonï¼Œ æ‰¾åˆ° babel å­—æ®µï¼Œ æ·»åŠ <code>&quot;plugins&quot;: [ &quot;@babel/plugin-proposal-decorators&quot; ]</code></li>
</ul>
<h2 id="3-mobx-react"><a href="#3-mobx-react" class="headerlink" title="3.mobx-react"></a>3.mobx-react</h2><h3 id="åœ¨-Class-ç»„ä»¶ä½¿â½¤-mobx"><a href="#åœ¨-Class-ç»„ä»¶ä½¿â½¤-mobx" class="headerlink" title="åœ¨ Class ç»„ä»¶ä½¿â½¤ mobx"></a>åœ¨ Class ç»„ä»¶ä½¿â½¤ mobx</h3><ul>
<li>è®¾ç½® Store</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; observable, action &#125; from &#x27;mobx&#x27;;</span><br><span class="line">class AboutStore &#123;</span><br><span class="line"> @observable counter = 1;</span><br><span class="line"> @action add() &#123;</span><br><span class="line"> this.counter++;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default new AboutStore;</span><br></pre></td></tr></table></figure>

<ul>
<li>æä¾›æ•°æ®æº</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; Provider &#125; from &#x27;mobx-react&#x27;;</span><br><span class="line">ReactDOM.render(</span><br><span class="line"> &lt;React.StrictMode&gt;</span><br><span class="line"> &lt;Router&gt;</span><br><span class="line"> &lt;Provider homeStore=&#123;homeStore&#125; aboutStore=&#123;aboutStore&#125;&gt;</span><br><span class="line"> &lt;App /&gt;</span><br><span class="line"> &lt;/Provider&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/Router&gt;</span><br><span class="line"> &lt;/React.StrictMode&gt;,</span><br><span class="line"> document.getElementById(&#x27;root&#x27;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨æ•°æ®æº</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; observer, inject &#125; from &#x27;mobx-react&#x27;;</span><br><span class="line">@inject(&#x27;aboutStore&#x27;)</span><br><span class="line">@inject(&#x27;homeStore&#x27;)</span><br><span class="line">@observer</span><br><span class="line">class About extends Component &#123;</span><br><span class="line"> render() &#123;</span><br><span class="line"> return (</span><br><span class="line"> &lt;div&gt;</span><br><span class="line"> &lt;h1&gt;About&lt;/h1&gt;</span><br><span class="line"> &lt;p&gt;current counter : &#123;this.props.aboutStore.counter&#125;&lt;/p&gt;</span><br><span class="line"> &lt;p&gt;home counter: &#123;this.props.homeStore.counter&#125;&lt;/p&gt;</span><br><span class="line"> &lt;Link to=&quot;/&quot;&gt;å»â¾¸â»š&lt;/Link&gt;</span><br><span class="line"> &lt;/div&gt;</span><br><span class="line"> );</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="åœ¨å‡½æ•°ç»„ä»¶ä½¿â½¤-mobx"><a href="#åœ¨å‡½æ•°ç»„ä»¶ä½¿â½¤-mobx" class="headerlink" title="åœ¨å‡½æ•°ç»„ä»¶ä½¿â½¤ mobx"></a>åœ¨å‡½æ•°ç»„ä»¶ä½¿â½¤ mobx</h3><ul>
<li>è®¾ç½® Store</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; observable, action, computed &#125; from &#x27;mobx&#x27;;</span><br><span class="line">export class HomeStore &#123;</span><br><span class="line"> @observable counter = 1;</span><br><span class="line"> @computed get doubleCounter() &#123;</span><br><span class="line"> return this.counter * 2;</span><br><span class="line"> &#125;</span><br><span class="line"> @action add() &#123;</span><br><span class="line"> this.counter++;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»º Context å¯¹è±¡</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import &#123; HomeStore &#125; from &#x27;../stores/home&#x27;;</span><br><span class="line">import &#123; AboutStore &#125; from &#x27;../stores/about&#x27;;</span><br><span class="line">export const storesContext = React.createContext(&#123;</span><br><span class="line"> homeStore: new HomeStore(),</span><br><span class="line"> aboutStore: new AboutStore()</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>useContext</li>
</ul>
<p>è®¾ç½® useStores å‡½æ•°ï¼Œâ½¤äºåœ¨å‡½æ•°ç»„ä»¶<br>å†…è·å– context å¯¹è±¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import &#123; storesContext &#125; from &#x27;../contexts&#x27;;</span><br><span class="line">export const useStores = () =&gt; React.useContext(storesContext);</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿â½¤ context</li>
</ul>
<p>è§‚å¯Ÿç»„ä»¶ï¼Œé€šè¿‡ useStore è·å– context<br>å¯¹è±¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; observer &#125; from &#x27;mobx-react&#x27;;</span><br><span class="line">import &#123; useStores &#125; from &#x27;../hooks/use-stores&#x27;;</span><br><span class="line">const About = observer(() =&gt; &#123;</span><br><span class="line"> const &#123; homeStore, aboutStore &#125; = useStores();</span><br><span class="line"> return (</span><br><span class="line"> &lt;div&gt;</span><br><span class="line"> &lt;h1&gt;About&lt;/h1&gt;</span><br><span class="line"> &lt;p&gt;current counter : &#123;aboutStore.counter&#125;&lt;/p&gt;</span><br><span class="line"> &lt;p&gt;home counter: &#123;homeStore.counter&#125;&lt;/p&gt;</span><br><span class="line"> &lt;/div&gt;</span><br><span class="line"> )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å‚è€ƒ</strong></p>
<ul>
<li><a href="https://cn.mobx.js.org/">mobx ä¸­æ–‡æ–‡æ¡£</a></li>
</ul>
]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
</search>
